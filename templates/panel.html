<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de administraci√≥n</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f6f7;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #1a5276;
      color: white;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 22px;
    }

    .logout-btn {
      background-color: #f44336;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }

    .logout-btn:hover {
      background-color: #c0392b;
    }

    main {
      padding: 40px;
      text-align: center;
    }

    .card {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .card h2 {
    color: #1a5276;
    }

    .icono-accion {
      margin-right: 10px;
      text-decoration: none;
      font-weight: bold;
    }

    .icono-accion.ver {
      color: #2980b9;
    }

    .icono-accion.eliminar {
      color: #e74c3c;
    }

    td.nombre-pdf-sin-entrenar {
      color: red;
      font-weight: bold;
    }

    td.nombre-pdf-entrenado {
      color: green;
      font-weight: bold;
    }
</style>

  </style>
</head>
<body>
  <header>
    <h1>Panel del Chatbot</h1>
    <form action="{{ url_for('logout') }}" method="GET">
      <button class="logout-btn">Cerrar sesi√≥n</button>
    </form>
  </header>

  <main>
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div style="color: green; font-weight: bold; text-align: center; margin-bottom: 20px;">
        {% for message in messages %}
          <p>{{ message }}</p>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; padding: 20px;">

    <!-- üî≥ COLUMNA IZQUIERDA -->
    <div style="flex: 1; min-width: 300px; max-width: 450px;">
      <!-- üìÑ Subir PDF -->
      <div class="card">
        <h2>üìÑ Subir PDF</h2>
        <form method="POST" enctype="multipart/form-data" action="/subir_pdf">
          <input type="file" name="archivo_pdf" accept="application/pdf" required style="margin-bottom: 15px;">
          <br>
          <button type="submit">Subir PDF</button>
        </form>
      </div>

      <!-- üìÅ Archivos Subidos -->
      <div class="card" style="margin-top: 30px;">
        <h2>üìÅ Archivos subidos</h2>
        {% if lista_pdfs %}
          <table style="width: 100%; border-collapse: collapse; table-layout: fixed;">
            <thead>
              <tr style="background-color: #d6eaf8;">
                <th style="padding: 8px; border: 1px solid #ccc;">Archivo</th>
                <th style="padding: 8px; border: 1px solid #ccc;">Fecha</th>
                <th style="padding: 8px; border: 1px solid #ccc;">Estado</th>
                <th style="padding: 8px; border: 1px solid #ccc;">Acciones</th>
              </tr>
            </thead>
            <!-- üìÅ Selecciona el Color del Archivo si esta entrenado o no -->
            <tbody>
              {% for pdf in lista_pdfs %}
                <tr>
                  <td style="padding: 8px; border: 1px solid #ccc; word-break: break-word; max-width: 180px;">
              {% if pdf[3] %}
                  <span style="color: green; font-weight: bold;">{{ pdf[1] }}</span>
              {% else %}
                  <span style="color: red; font-weight: bold;">{{ pdf[1] }}</span>
              {% endif %}
            </td>
                  <td style="padding: 8px; border: 1px solid #ccc;">{{ pdf[2].strftime('%Y-%m-%d %H:%M') }}</td>
                  <td style="padding: 8px; border: 1px solid #ccc;">
                    {% if pdf[3] %}‚úÖ Entrenado{% else %}‚è≥ Sin entrenar{% endif %}
                  </td>
                  <td style="padding: 8px; border: 1px solid #ccc;">
                    <div class="acciones-links">
                      <a href="{{ url_for('ver_pdf', nombre_archivo=pdf[1]) }}">üëÅ Ver</a>
                      <a href="{{ url_for('eliminar_pdf', nombre_archivo=pdf[1]) }}" onclick="return confirm('¬øEst√°s seguro de eliminar este archivo?');" style="color: red;">üóë Eliminar</a>
                    </div>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p>No se han subido archivos todav√≠a.</p>
        {% endif %}
      </div>
    </div>

    <!-- üü• COLUMNA DERECHA: visor -->
    <div class="card" style="flex: 2; min-width: 400px;">
      <h2>üëÅÔ∏è Visualizador de PDF</h2>
      {% if ultimo_pdf %}
        <iframe 
          src="{{ url_for('static', filename='uploads/' + ultimo_pdf) }}" 
          width="100%" height="500px" style="border: 1px solid #ccc;"></iframe>
      {% else %}
        <p>No se ha seleccionado ning√∫n archivo todav√≠a.</p>
      {% endif %}
    </div>

  </div>
</main>
</body>
</html>
